# Redis 标准版-双副本 {#concept_qf3_kjh_tdb .concept}

## 简介 {#section_pvv_kjh_tdb .section}

云数据库 Redis 标准版-双副本模式采用主从（Replication）模式搭建。主节点提供日常服务访问，备节点提供 HA 高可用，当主节点发生故障，系统会自动在30秒内切换至备节点，保证业务平稳运行。

![](http://static-aliyun-doc.oss-cn-hangzhou.aliyuncs.com/assets/img/3105/6584_zh-CN.png)

## 特点 {#section_tk1_zjh_tdb .section}

-   **可靠性**

    -   服务可靠

        采用双机主备架构，主备节点位于不同物理机。主节点对外提供访问，用户可通过 Redis 命令行和通用客户端进行数据的增删改查操作。当主节点出现故障，自研的 HA 系统会自动进行主备切换，保证业务平稳运行。

    -   数据可靠

        默认开启数据持久化功能，数据全部落盘。支持数据备份功能，用户可以针对备份集回滚实例或者克隆实例，有效地解决数据误操作等问题。同时还具备同城容灾能力。

-   **兼容性**

    云数据库 Redis 标准版在 Redis 2.8基础上进行开发，100%兼容 Redis 协议命令。自建的 Redis 数据库可以平滑迁移至 Redis 标准版。阿里云还提供数据传输工具（DTS）支持用户进行增量的 Redis 迁移，保证业务平稳过渡。

-   **阿里云自研**

    -   故障探测切换系统（HA）

        阿里云 Redis 服务封装 HA 切换系统，实时探测主节点的异常情况，可以有效解决磁盘 IO 故障，CPU 故障等问题导致的服务异常，及时进行主备切换，从而保证服务高可用。

    -   主备复制机制

        阿里云针对 Redis 主从复制机制进行了定制修改，采用增量日志格式进行复制传输。当主备复制中断后，对系统性能及稳定性影响极低，有效地避免了 Redis 原生复制的弊端。

        Redis 原生复制弊端简要如下：

        -   Redis 复制中断后，Slave 会立即发起 psync，psync 尝试部署同步，但是不成功，就会全量同步 RDB 并发送至 Slave 节点。

        -   如果 Redis 全量同步，会导致主节点执行全量备份，进程 Fork，可造成主节点达到毫秒或秒级的卡顿。

        -   Redis 进程 Fork 导致 Copy-On-Write ，Copy-On-Write导致主节点进程内存消耗，极端情况下造成主节点内存溢出，程序异常退出。

        -   Redis 主节点生成备份文件导致服务器磁盘 IO 和 CPU 资源消耗。

        -   发送GB 级别大小的备份文件，会导致服务器网络出口爆增，磁盘顺序 IO 吞吐量高，期间会影响业务正常请求响应时间，并产生其他连锁影响。


## 使用场景 {#section_zzn_1kh_tdb .section}

-   **对 Redis 协议兼容性要求较高的业务**

    标准版完全兼容 Redis 协议，业务可以平滑迁移。

-   **Redis 作为持久化数据存储使用的业务**

    标准版提供持久化机制及备份恢复机制，极大地保证数据可靠性。

-   **单个 Redis 性能压力可控**

    由于 Redis 原生采用单线程机制，性能在10万 QPS 以下的业务建议使用。如果需要更高的性能要求，请选用集群版本。

-   **Redis 命令相对简单，排序、计算类命令较少**

    由于 Redis 的单线程机制，CPU 会成为主要瓶颈。如排序、计算类较多的业务建议选用集群版配置。


