### 日期：2017-5-14 15:22:45

#### 一、基础框架搭建


**待办事项：**

**1.PageHelper分页		2017年5月14日18:08:20**

**2.Logback日志记录 2017年5月14日16:22:45**

**3.统一异常处理  2017年5月14日19:14:24**

**4.LogAOP慢日志记录 2017年5月15日17:22:59**

**5.常量包 2017年5月16日14:14:20**

**6.多环境配置 2017年5月15日20:27:01**

7.系统日志记录（annotation+拦截器/AOP）

**8.自定义异常 2017年5月14日18:36:38**

**9.Result		2017年5月14日18:08:20**

**10.跨域请求的过滤器 2017年5月14日19:25:45**

**11.entity分包（PO/IO/VO）	2017年5月14日18:08:20**

12.项目名称定夺

**13.valid验证 2017年5月14日19:15:57**

14.durid监控

**15.redis 2017年5月19日11:13:04**

**16.fastdfs OR qiniu 2017年5月16日16:55:53 已选七牛**

17.p6spy

**18.page-info.java 2017年5月15日17:26:17**

**19.事物 2017年5月16日12:17:52**
****

### 日期：2017-5-14 18:06:30

#### 二、完善框架

**完成如下内容**

1.PageHelper分页

2.新增Result

3.entity分包（PO/IO/VO）

4.新增自定义异常BussinessException

5.封装统一返回结果的ResultCreator

6.统一异常处理

7.valid验证

8.跨域请求的过滤器CorsFilter

9.logback完成
****

### 日期：2017-5-15 17:20:25

#### 三、完善框架

**完成如下内容**

1.LogAOP慢日志的记录

2.完善package-info.java

3.完成多环境部署
****

### 日期：2017年5月16日12:17:01

#### 四、完善框架

**完成如下内容**

1.事物

2.枚举常量包

3.七牛工具类以及七牛多环境
****

### 日期：2017年5月17日11:29:14

#### 五、新增爬虫工具类

**完成如下内容**

1.完成爬虫，并将爬下来的图片上传到七牛和db

2.重新整理包结构
****

### 日期：2017年5月18日16:15:18

#### 六、新增打包下载功能

**完成如下内容**

1.完成调用七牛打包下载接口，将多个图片打包成zip

2.新增统一异常处理器（并非拦截器自动捕获异常，而是检查是否可能会出现异常比如非空判断等，需手动调用）

3.新增cache层，目前集成了redis
****

### 日期 2017年5月19日11:10:54

#### 七、完善Redis

**完成如下内容**

1.导出时，将zip名存到redis的set集合中（set不重复）

2.新增QiNiuTask，每天凌晨三点开始跑程序，读取redis删除空间上无用的zip包

3.完成Redis的list和set基础工具类

5.新增InitDataService，负责初始化一些数据到redis

4.完成图片分类查询接口，从redis里读取。
****

### 日期 2017年5月21日17:36:58

#### 八、开发图片列表

**完成如下内容**

1.容器启动时将图片按照分类放到redis的list中

2.按照不同分类id去redis查找不同图片，redis的List操作分页。

3.完成Redis的Hash类型的读取和put方法

4.boot-parent包1.5.2貌似不兼容redis，注入RedisTemplate一直说nosuch bean，所以降低版本为1.4.5

### 日期 2017年5月22日15:42:21

#### 九、优化代码

**完成如下内容**

1.优化打zip包下载的代码，打包时直接指定名称，免得下载时候还需要调用接口拿名称那么啰嗦。

2.删除了entity下的hibernate valid验证包引用，springboot自带了。

3.新增task小任务日志记录，文件名doutu_task.log

4.Redis多环境

5.新增举报接口

6.新增举报审核接口
****

### 日期 2017年5月23日13:16:04

#### 十、新增自定义注解

**完成如下内容**

1.新增自定义注解验证，验证举报审核接口传来的status是否为2或3

2.新增图片点赞PO
****

### 日期 2017年5月26日17:54:31

#### 十一、优化代码

**完成如下内容**

1.优化初始化图片到redis的方法，新增判断是否有更新，没更新则不操作redis
****

### 日期 2017年5月27日11:35:06

#### 十一、新增图片标签，用于搜索

**完成如下内容**

1.重新爬图片，爬来的时候顺便打标签入标签表

2.完成标签表的设计和基本的PO,DAO,SERVICE,CONTROLLER

3.解决插入db时候中文乱码
****

### 日期 2017年5月29日22:55:03

#### 十二、完善以前代码的逻辑

**完成如下内容**

1.完成搜索功能，根据标签名称搜索

2.完善举报功能，举报前验证是否当前用户已经举报过此图片，或此图片是否不存在。

3.新增审核时需要写反馈说明

4.新增后台审核时候需要显示的待审核的图片信息列表
****

### 日期 2017年5月30日15:22:56

#### 十三、完善举报和点赞功能

**完成如下内容**

1.修改图片列表页方法实现，将redis的list换成了zset，为了是zset可以根据内容方便的删除元素和统计点赞数，这样一来举报和点赞就解决了。

2.完善了举报审核通过的功能接口。

3.新增ZSet工具类

4.完成点赞接口，插入db，同时更新zset的count
****

### 日期 2017年5月31日14:59:28

#### 十四、新增manager-controller

**完成如下内容**

1.新增manager-controller的moudle

2.manager-controller基础框架搭建，完成配置和Demo测试

3.在manager-controller里新增举报审核功能和查看被举报的图片接口

4.新增友链表和保存接口

5.删除友链接口

6.友链查看详情接口

7.友链的列表查询（按照topNum倒序排序）

8.编辑友链信息

9.新增查询某用户点赞过哪些图片接口
****

### 日期 2017年6月1日09:26:02

#### 十五、完成系统日志记录

**完成如下内容**

1.完成系统日志的表设计以及PO

2.完成系统日志记录的基本，采取两个注解的方式和一个注解处理器。

3.完成系统日志记录的保存到db中功能
****

### 日期 2017年6月4日11:52:02

#### 十六、文件上传、极验验证

**完成如下内容**

1.完成极验验证
****

### 日期 2017年6月9日10:52:42

#### 十七、Thymeleaf

**完成如下内容**

1.完成Thymeleaf的配置

2.管理端新增极验完成
****

### 日期 2017年6月10日16:34:52

#### 十八、User表

**完成如下内容**

1.User的PO-》Controller等

2.完成简易版的login功能

3.修复以前bug：
    3.1.只要抛出异常，所有code返回都是2，现在按异常不同返回不同code
    3.2.返回给客户端的日期类型是毫秒值，换成了yyyy-MM-dd HH:mm:ss
    3.3.修复redis的bug，缓存在redis里的图片无法删除，因为key没有序列化
    
4.补充业务层的log

5.登陆密码进行MD5加密

6.IO补充非空注解@NotEmpty，@NotNull，@NotBlank

7、完善登录，新增isAdmin判断，非admin不能登录

8、session验证的过滤器，登录页面和登录接口不过滤
****

### 日期 2017年6月11日20:57:11

#### 十九、采取H-UI框架作为后台

**完成如下内容**

1.将H-UI的login页面导入了项目中，还未进行调试。

2.新增静态资源过滤的类
****

### 日期 2017年6月12日13:04:17

#### 十九、采取H-UI框架作为后台UI框架，artTemplate作为JS模板

**完成如下内容**

1.移除springboot中的thymeleaf，采取前后分离
****

### 日期 2017年6月13日10:38:26

#### 二十、新增test测试环境多环境部署

1.完成斗图的保存功能 -- admin端
    1.1上传到七牛
    1.2存到db
    1.3存到redis
2.图片列表接口 -- admin端

3.分类列表接口 -- admin端
****

### 日期 2017年6月15日20:55:38

#### 二十一、admin端的列表展示

1.完成admin端的列表展示（前+后，前台差分页）

2.将只有0和1的换成换成了boolean
****

### 日期 2017年6月16日14:22:28

#### 二十二、完善admin 端的图片列表

1.完成图片列表搜索功能，按照开始结束日期、上传人、分类四个条件

2.新增是否作废过滤条件筛选

3.完成admin作废功能
****

### 日期 2017年6月19日19:28:47

#### 二十三、完成图片列表主页的接口

1.完成图片列表主页接口，主页按照时间倒序排序
****

### 日期 2017年6月20日13:36:22

#### 二十四、修复bug

1.修复搜索bug，按照时间倒序排序
****

### 日期 2017年6月21日13:43:07

#### 二十五、完成后端根据网址批量上传图片

1.完成根据url，catalogName，catalogId，page批量上传图片。

2.新增爬虫工具类，将计算byte方法抽离到此工具类下

3.反馈表的设计，PO/IO/VO等

4.新增反馈的保存接口

5.反馈表新增status字段 处理状态 1:待处理 2::已采纳 3:已放弃

6.新增 admin 端的反馈列表查询接口
****

### 日期 2017年6月22日18:07:14

#### 二十六、新增处理反馈状态接口

1.新增处理反馈状态接口 -- admin

****

### 日期 2017年7月11日11:04:09

#### 二十七、新增图片宽高，方便瀑布流

1.picture和picture_tag表新增width和height，写了个TestTask，里面放了获取七牛云的图片，计算出宽高存到db

2.list接口返回的VO新增width和height字段

3.将以前的图片分类接口改成了查询db，不从redis里取了，后期直接换成ES。

4.新增系统更新日志表，以及查询接口，每次项目上线都在这里记录上线内容

5.更新日志的保存功能以及后台管理系统的更新日志列表+保存


****

### 日期 2017年7月14日20:09:49

#### 二十八、反馈接口新增验证码

1.反馈接口新增验证码

2.新增验证码接口